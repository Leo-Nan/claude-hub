# Claude Hub 设计文档

## 1. 项目概述

### 项目名称
Claude Hub

### 项目定位
基于 Claude Code 的桌面客户端，提供项目管理、Agent 可视化、状态监控等功能。

### 核心理念
- 极简设计：线条 + 文字 + 状态点
- 场景化：像 Codex GUI 一样简洁
- 可扩展：轻量改善用户体验

---

## 2. 核心功能

### 2.1 项目管理
- 左侧边栏显示项目列表
- 一键新建/切换项目
- 每个项目独立配置

### 2.2 Agent 树状图
- 显示 Agent 层级关系
- 状态指示（活跃/空闲/思考中）
- 能力标签
- 可调出/隐藏

### 2.3 状态监控
- Token 用量
- 活跃 Agent 数量
- 任务进度

### 2.4 快速启动
- 一键启动指定项目的 Claude 会话
- 支持多开

---

## 3. 界面设计

### 3.1 主界面布局

```
┌────────────────────────────────────────────────────────┐
│  标题栏：Claude Hub                          [─][□][×] │
├────────┬───────────────────────────────────────────────┤
│        │                                               │
│ 项目    │           对话区域                            │
│ 列表    │                                               │
│        │                                               │
│ ├─A    │                                               │
│ ├─B    │                                               │
│ └─+新  │                                               │
│        │                                               │
├────────┴───────────────────────────────────────────────┤
│  [Agent树状图] [状态]                                  │
└────────────────────────────────────────────────────────┘
```

### 3.2 Agent 树状图（可调出）

```
● 私人秘书
├─ ● 调研员
│   └─ 能力: 搜索, 整理
├─ ● 工程师
│   └─ 能力: 前端, 后端
└─ ● 审查员
    └─ 能力: 代码审查

状态: ●活跃(绿)  ○空闲(灰)  ◐思考中(黄)
```

### 3.3 状态栏

```
Token: 125K/200K  |  活跃Agent: 3  |  Session: 00:23:45
```

### 3.4 视觉风格

| 元素 | 样式 |
|------|------|
| 颜色 | 灰度为主，重点用蓝 |
| 字体 | 系统默认，14px |
| 线条 | 1px 细线 |
| 状态点 | 8px 圆点 |
| 间距 | 8px 基础单位 |

---

## 4. 技术架构

### 4.1 技术栈

```
├── Electron          # 桌面框架
├── React            # UI 库
├── TypeScript       # 语言
└── electron-store   # 本地存储
```

### 4.2 模块设计

```
src/
├── main/              # Electron 主进程
│   ├── index.ts       # 入口
│   ├── ipc.ts        # 进程通信
│   └── store.ts      # 持久化
├── renderer/          # 渲染进程
│   ├── App.tsx       # 主组件
│   ├── components/    # UI 组件
│   │   ├── Sidebar.tsx
│   │   ├── Chat.tsx
│   │   ├── AgentTree.tsx
│   │   └── StatusBar.tsx
│   ├── hooks/         # 逻辑钩子
│   └── stores/        # 状态管理
└── shared/            # 共享类型
    └── types.ts
```

### 4.3 数据流

```
┌─────────────┐     IPC      ┌─────────────┐
│  Renderer   │ ◄──────────► │    Main     │
│  (React)    │              │  (Electron) │
└──────┬──────┘              └──────┬──────┘
       │                            │
       │                           │
       ▼                            ▼
┌─────────────┐             ┌─────────────┐
│  本地状态    │             │  文件系统   │
│  (Zustand)  │             │  (Claude)   │
└─────────────┘             └─────────────┘
```

### 4.4 Claude 集成方式

```typescript
// 启动 Claude 会话
async function spawnClaude(projectPath: string) {
  const child = spawn('claude', [], {
    cwd: projectPath,
    stdio: ['pipe', 'pipe', 'pipe']
  });

  // 捕获输出
  child.stdout.on('data', (data) => {
    // 发送到 renderer
    ipcRenderer.send('claude-output', data.toString());
  });

  return child;
}
```

---

## 5. 功能详情

### 5.1 项目管理

| 功能 | 描述 |
|------|------|
| 列表展示 | 显示所有已添加项目 |
| 添加项目 | 选择文件夹添加到列表 |
| 删除项目 | 从列表移除（可选是否删除配置） |
| 快速切换 | 点击切换当前项目 |

### 5.2 Agent 树状图

| 功能 | 描述 |
|------|------|
| 层级展示 | 显示 Agent 上下级关系 |
| 状态同步 | 实时显示 Agent 状态 |
| 能力标签 | 显示每个 Agent 的技能 |
| 交互 | 点击查看详情 |

### 5.3 状态监控

| 指标 | 数据来源 |
|------|----------|
| Token 用量 | Claude 输出解析 |
| 活跃数 | 会话状态 |
| 运行时间 | 进程计时 |

### 5.4 快捷操作

| 操作 | 触发 |
|------|------|
| 新建项目 | 点击 + 按钮 |
| 调出树状图 | 点击底部 Tab |
| 调出状态 | 点击底部 Tab |
| 新建 Agent | 通过私人秘书对话 |

---

## 6. MVP 功能范围

### 第一版 (MVP)

```
✓ 项目列表展示
✓ 切换项目
✓ 启动 Claude 会话（终端模式）
✓ 基础 Agent 树状图
✓ Token 用量统计
```

### 第二版

```
✓ Agent 状态实时同步
✓ 多会话管理
✓ 树状图能力标签
✓ 可配置 Agent 模板
```

### 第三版

```
✓ Agent 创建自然语言界面
✓ 数据流向可视化
✓ 任务进度追踪
✓ 插件系统
```

---

## 7. 配置文件结构

### 项目配置 (.claude-hub/project.json)

```json
{
  "id": "uuid",
  "name": "项目名",
  "path": "/path/to/project",
  "agents": [
    {
      "name": "调研员",
      "type": "researcher",
      "skills": ["search", "organize"]
    }
  ],
  "createdAt": "2024-01-01",
  "lastOpened": "2024-01-15"
}
```

### 全局配置 (.claude-hub/config.json)

```json
{
  "theme": "light",
  "sidebarWidth": 200,
  "showStatusBar": true,
  "showAgentTree": true,
  "projects": ["uuid1", "uuid2"]
}
```

---

## 8. 未来可能的扩展

- [ ] Agent 创建/编辑界面
- [ ] 项目模板系统
- [ ] 团队协作模式
- [ ] 云端配置同步
- [ ] 主题自定义

---

## 9. 风险与限制

| 风险 | 缓解措施 |
|------|----------|
| CLI 输出格式变化 | 优雅降级，提示用户 |
| 状态同步延迟 | 轮询 + 事件 |
| 多会话管理复杂 | MVP 暂不支持 |

---

## 10. 相关参考

- Codex GUI
- Claude Code CLI
- Electron 文档
- React + TypeScript 最佳实践
